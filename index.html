<!doctype html>

<html lang="ja">
<head>
<meta charset="utf-8">
<title>Beatboxer図鑑</title>
<link rel="stylesheet" href="style.css">
<style>
/* 最小限のモーダル用スタイル（既存CSSに影響しないよう軽く） */
.modal-backdrop{
  position:fixed; inset:0; background:rgba(0,0,0,.5);
  display:flex; align-items:center; justify-content:center;
  z-index:999;
}
.modal{ background:var(--card, #151a22); color:var(--fg, #e6e9ef);
  border:1px solid var(--border, #232a35); border-radius:.75rem;
  width:min(480px, 92vw); padding:1rem; box-shadow:0 10px 24px rgba(0,0,0,.35);
}
.modal h3{ margin:.2rem 0 1rem; }
.modal .row{ display:flex; flex-direction:column; gap:.35rem; margin:.6rem 0; }
.modal input{ padding:.6rem .7rem; border:1px solid var(--border, #232a35);
  border-radius:.6rem; background:var(--bg, #0e1116); color:inherit; }
.modal .actions{ display:flex; gap:.5rem; justify-content:flex-end; margin-top:.8rem; }
.link-like{ background:transparent; border:0; color:var(--muted,#9aa6b2); cursor:pointer; }
[hidden]{ display:none !important; }
.fav.toggle{ align-self:end; }
.fav-btn{ position:absolute; top:.5rem; right:.5rem; z-index:1;
  border:1px solid var(--border); background:var(--card); border-radius:.5rem;
  padding:.2rem .45rem; cursor:pointer;
}
.fav-btn.on{ color:#ffd54a; }
</style>
  
</head>
<body>
  <div class="layout">

    <!-- Header -->
    <header>
      <h1>Beatboxer図鑑</h1>
      <div id="authArea" style="margin-left:auto; display:flex; gap:.5rem; align-items:center;">
        <span id="userEmail" class="meta"></span>
        <button id="loginBtn" class="btn" type="button">ログイン</button>
        <button id="logoutBtn" class="btn" type="button" style="display:none;">ログアウト</button>
      </div>
    </header>

    <!-- Sidebar（メニューのみ） -->
    <aside id="sidebar" aria-label="メニュー">
      <nav class="menu">
        <button class="menu-item active" id="menuHome">Beatboxer一覧</button>
      </nav>
      <footer class="menu-note">今後ここに他メニューを追加予定</footer>
    </aside>

    <!-- Main -->
    <main>

      <!-- 一覧 -->
      <section id="listView">
        <!-- ツールバー -->
        <div id="toolbar" class="toolbar">
          <label class="ctl">
            <span>国籍</span>
            <select id="filterCountry"></select>
          </label>

          <label class="ctl">
            <span>年齢（最小）</span>
            <input id="ageMin" type="number" inputmode="numeric" placeholder="任意">
          </label>

          <label class="ctl">
            <span>年齢（最大）</span>
            <input id="ageMax" type="number" inputmode="numeric" placeholder="任意">
          </label>

          <label class="ctl">
            <span>並び替え</span>
            <select id="sortBy">
              <option value="name-asc">名前：A → Z</option>
              <option value="name-desc">名前：Z → A</option>
            </select>
          </label>

          <!-- 追加：お気に入りのみ表示トグル -->
          <button id="favOnlyBtn" type="button" class="toggle fav">☆ お気に入りのみ</button>
        </div>

        <div id="list" class="grid"></div>
      </section>

      <!-- 詳細 -->
      <section id="detailView" hidden>
        <nav class="detail-breadcrumb">
          <button id="backToList" class="btn">← 一覧へ戻る</button>
        </nav>
        <article id="profile" class="detail"></article>
      </section>
    </main>
  </div>

  <!-- ログイン／新規登録モーダル -->
  <div id="authBackdrop" class="modal-backdrop" hidden>
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="authTitle">
      <div style="display:flex; justify-content:space-between; align-items:center;">
        <h3 id="authTitle">ログイン / 新規登録</h3>
        <button id="authClose" class="link-like" type="button">閉じる ✕</button>
      </div>
      <form id="authForm">
        <div class="row">
          <label for="authEmail">メールアドレス</label>
          <input id="authEmail" type="email" autocomplete="email" required>
        </div>
        <div class="row">
          <label for="authPassword">パスワード</label>
          <input id="authPassword" type="password" autocomplete="current-password" required>
        </div>
        <div id="authMsg" class="meta"></div>
        <div class="actions">
          <button id="btnSignUp"  class="btn" type="button">新規登録</button>
          <button id="btnSignIn"  class="btn" type="submit">ログイン</button>
        </div>
      </form>
    </div>
  </div>

  <!-- App scripts -->
  <script src="script.js"></script>

  <!-- Supabase UMD（ブラウザ用） -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- 認証だけを担当するスクリプト（sb を作成し、フォームイベントをバインド） -->
  <script>
    // モーダルの開閉（超ミニJS：auth.jsに書いてもOK）
    const loginBtn    = document.getElementById('loginBtn');
    const logoutBtn   = document.getElementById('logoutBtn');
    const backdrop    = document.getElementById('authBackdrop');
    const closeBtn    = document.getElementById('authClose');
  
    loginBtn?.addEventListener('click', () => { backdrop.hidden = false; });
    closeBtn?.addEventListener('click', () => { backdrop.hidden = true; });
  
    // ログイン成功時に auth.js から呼べるように
    window.__closeAuthModal = () => { backdrop.hidden = true; };
  </script>
  
</body>
</html>

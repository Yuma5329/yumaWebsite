<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Beatboxer図鑑</title>
<style>
  /* ===== Theme & scalable sizes ===== */
  :root{
    /* 色 */
    --bg:#0f1115; --fg:#e7e7e7; --card:#161a22; --muted:#9aa4b2; --border:#262b36; --accent:#6aa8ff;
    /* 可変寸法（すべて相対）：clamp(min, preferred, max) */
    --headerH: clamp(3rem, 6vw, 4.2rem);
    --sidebarW: clamp(14rem, 20vw, 18rem);
    --radius: 0.75rem;
    --gap: clamp(0.6rem, 1.2vw, 0.9rem);
    --wrapMax: 112rem; /* 最大幅は超広画面でも破綻しないように */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;background:var(--bg);color:var(--fg)}

  /* ===== Layout ===== */
  .layout{
    display:grid;
    grid-template-columns: var(--sidebarW) 1fr;
    grid-template-rows: var(--headerH) 1fr;
    min-height:100vh;
    max-width:var(--wrapMax);
    margin:0 auto;
  }

  /* Header (sticky, scalable) */
  header{
    grid-column:1 / -1;
    position:sticky; top:0;
    display:flex; align-items:center; gap:var(--gap);
    padding-inline: clamp(0.8rem, 2vw, 1.2rem);
    border-bottom:1px solid var(--border);
    backdrop-filter: blur(8px);
    background: color-mix(in oklab, var(--bg) 85%, transparent);
    z-index:10;
  }
  h1{margin:0; font-size:clamp(1.1rem, 2.2vw, 1.4rem); font-weight:700}
  #q{
    flex:1; min-width:12rem;
    padding:0.7rem 0.9rem; border:1px solid var(--border); border-radius:var(--radius);
    background:var(--card); color:var(--fg); font-size:1rem;
  }
  .btn{
    padding:0.7rem 0.9rem; border:1px solid var(--border); border-radius:var(--radius);
    background:var(--card); color:var(--fg); cursor:pointer; font-size:0.95rem;
  }
  #menuBtn{display:none}

  /* Sidebar: own scroll on desktop */
  aside#sidebar{
    border-right:1px solid var(--border);
    background:var(--card);
    padding: clamp(0.6rem, 1.2vw, 0.9rem);
    position:sticky; top:var(--headerH);
    align-self:start;
    max-height: calc(100vh - var(--headerH));
    overflow:auto;
  }
  .secTitle{margin:0.4rem 0 0.5rem; font-size:0.85rem; color:var(--muted); letter-spacing:0.02em}
  .nav{display:flex; flex-direction:column; gap:0.4rem; margin-bottom:0.8rem}
  .nav button{all:unset; display:block; padding:0.55rem 0.7rem; border:1px solid var(--border); border-radius:var(--radius); cursor:pointer; font-size:0.95rem}
  .nav button.active{border-color:var(--accent); box-shadow:0 0 0 1px var(--accent) inset}

  /* Content */
  main{padding: clamp(0.8rem, 1.5vw, 1.2rem)}
  .grid{
    display:grid;
    grid-template-columns: repeat(auto-fill, minmax(clamp(14rem, 28vw, 20rem), 1fr));
    gap: var(--gap);
  }
  .card{background:var(--card); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden}
  .thumb, iframe{width:100%; aspect-ratio:16/9; border:0; background:#000; display:block; object-fit:cover}
  .pad{padding: clamp(0.6rem, 1.2vw, 0.9rem)}
  .name{margin:.2em 0 .5em; font-size:clamp(1rem, 1.6vw, 1.2rem); font-weight:600}
  .meta{font-size:clamp(0.8rem, 1.2vw, 0.95rem); color:var(--muted)}
  .tags{display:flex; flex-wrap:wrap; gap:0.4rem; margin-top:0.5rem}
  .tag{font-size:clamp(0.72rem, 1vw, 0.85rem); border:1px solid var(--border); border-radius:999px; padding:0.25rem 0.55rem}

  footer{color:var(--muted); font-size:0.85rem; margin:1rem 0}

  /* ===== Mobile drawer (<= 60rem ≒ 960px) ===== */
  @media (max-width:60rem){
    .layout{grid-template-columns: 1fr}
    #menuBtn{display:inline-flex}
    aside#sidebar{
      position:fixed; inset:var(--headerH) auto 0 0; width:min(80vw, 22rem);
      max-height: calc(100vh - var(--headerH));
      transform: translateX(-100%); transition: transform .2s ease;
      z-index:30;
    }
    aside#sidebar.open{ transform:none }
    .scrim{position:fixed; inset:0; background:#0008; display:none; z-index:20}
    .scrim.show{display:block}
  }
</style>
</head>
<body>
  <div class="layout">
    <!-- Header -->
    <header>
      <button id="menuBtn" class="btn" aria-label="メニュー">☰</button>
      <h1>Beatboxer図鑑</h1>
      <input id="q" type="search" placeholder="検索（名前・特徴・タグ）">
      <button id="clearBtn" class="btn">クリア</button>
    </header>

    <!-- Sidebar (scrolls independently) -->
    <aside id="sidebar" aria-label="サイドメニュー">
      <div>
        <p class="secTitle">国籍で絞り込み</p>
        <div id="navCountry" class="nav"></div>
      </div>
      <div>
        <p class="secTitle">GBB年別で絞り込み</p>
        <div id="navGBB" class="nav"></div>
      </div>
      <p class="secTitle">選択を解除</p>
      <button id="resetBtn" class="btn" style="width:100%">すべて表示</button>
      <footer>※年は代表動画に基づく暫定タグを含みます。</footer>
    </aside>
    <div class="scrim" id="scrim" aria-hidden="true"></div>

    <!-- Content -->
    <main>
      <div id="list" class="grid"></div>
    </main>
  </div>

<script>
/* ========= Data =========
 * country/gbbはメニューでフィルタ。ytIdがあればクリックで埋め込み再生。
 */
const DATA = [
  {name:"D-Low", country:"UK",     features:"高速・高精度",   tags:["キック","スピード"], gbb:["GBB2019"], ytId:"DFk6aVSWo7s", comment:"多彩な音と圧巻の構成。"},
  {name:"NaPoM", country:"USA",    features:"ベース/グルーヴ", tags:["ベース","バトル"],   gbb:["GBB2017"], ytId:"YYKMoZnuTJE", comment:"低音の安定感と展開力。"},
  {name:"Alem",  country:"France", features:"王道/構成美",     tags:["基礎","構成"],       gbb:["GBB2015"], ytId:"vD2Xwg3p_14", comment:"基礎から完成度が高い。"},
  {name:"Reeps One", country:"UK", features:"音色表現",        tags:["アート","実験"],     gbb:[], ytId:"Xj6rAa3G7Hc", comment:"表現の幅を広げる存在。"},
  {name:"MB14",  country:"France", features:"ルーパー/メロ",   tags:["メロディ","ループ"], gbb:["GBB2016"], ytId:"LMSlQFVnyvQ", comment:"歌心のあるライン。"},
  {name:"SO-SO", country:"Japan",  features:"ルーパー/個性派", tags:["日本","ループ"],     gbb:["GBB2021"], ytId:"aD0hK0ZsQeI", comment:"世界基準の独自路線。"},
  {name:"RUSY",  country:"Japan",  features:"高速バトル",       tags:["日本","スピード"],   gbb:["GBB2023"], ytId:"n5T0Uu7kV2c", comment:"鋭いリズムと迫力。"},
  {name:"Kohey", country:"Japan",  features:"メロ×ベース",      tags:["日本","メロ"],       gbb:[], ytId:"5Im1W7_5bGQ", comment:"歌と重低音の融合。"},
  {name:"HIKAKIN", country:"Japan",features:"先駆者",            tags:["日本","レジェンド"], gbb:[], ytId:"0bkrhTwfK_w", comment:"国内シーンを切り開いた存在。"},
  {name:"SARUKANI", country:"Japan", features:"クルー",         tags:["日本","チーム"],     gbb:["GBB2022"], ytId:"FvFgxqX2D4E", comment:"連携が魅力の4人組。"}
];

const $ = (q)=>document.querySelector(q);
const navCountry = $("#navCountry");
const navGBB = $("#navGBB");
const q = $("#q");
const clearBtn = $("#clearBtn");
const list = $("#list");

/* ----- Menu generation ----- */
const countries = ["All", ...Array.from(new Set(DATA.map(d=>d.country)))];
const gbbYears = ["All", ...Array.from(new Set(DATA.flatMap(d=>d.gbb)))].sort();
let selCountry = "All";
let selGBB = "All";

function makeButtons(container, items, selected, onClick){
  container.innerHTML = items.map(v=>`<button class="${v===selected?'active':''}" data-v="${v}">${v}</button>`).join("");
  container.querySelectorAll("button").forEach(b=> b.addEventListener("click", ()=>onClick(b.dataset.v)));
}
function refreshMenus(){
  makeButtons(navCountry, countries, selCountry, v=>{ selCountry=v; refreshMenus(); render(); });
  makeButtons(navGBB, gbbYears, selGBB, v=>{ selGBB=v; refreshMenus(); render(); });
}
refreshMenus();

/* ----- Cards ----- */
function thumbHTML(id, alt){
  const max = `https://i.ytimg.com/vi/${id}/maxresdefault.jpg`;
  const hq  = `https://i.ytimg.com/vi/${id}/hqdefault.jpg`;
  return `<img class="thumb" src="${max}" onerror="this.onerror=null;this.src='${hq}'" alt="${alt}">`;
}
function cardHTML(p){
  const tags = [...p.tags, ...p.gbb].map(t=>`<span class="tag">${t}</span>`).join("");
  return `
    <article class="card">
      <div onclick="playVideo('${p.ytId}', this)">${thumbHTML(p.ytId, p.name)}</div>
      <div class="pad">
        <div class="name">${p.name}（${p.country}）</div>
        <div class="meta">特徴：${p.features}</div>
        <div class="tags">${tags}</div>
        <div class="meta" style="margin-top:.4rem">${p.comment}</div>
      </div>
    </article>`;
}

/* ----- Filter + render ----- */
function normalize(x){return (x||"").toLowerCase();}
function render(){
  const term = normalize(q.value);
  const out = DATA.filter(p=>{
    if(selCountry!=="All" && p.country!==selCountry) return false;
    if(selGBB!=="All" && !p.gbb.includes(selGBB)) return false;
    if(term){
      const hay = normalize([p.name,p.country,p.features,p.tags.join(" "),p.gbb.join(" ")].join(" "));
      if(!hay.includes(term)) return false;
    }
    return true;
  });
  list.innerHTML = out.map(cardHTML).join("");
}
q.addEventListener("input", render);
clearBtn.addEventListener("click", ()=>{ q.value=""; render(); });
$("#resetBtn").addEventListener("click", ()=>{ selCountry="All"; selGBB="All"; q.value=""; refreshMenus(); render(); });
render();

/* ----- Play video ----- */
function playVideo(id, el){
  el.outerHTML = `<iframe src="https://www.youtube.com/embed/${id}?autoplay=1" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
}
window.playVideo = playVideo;

/* ----- Mobile drawer ----- */
const sidebar = $("#sidebar");
const scrim = $("#scrim");
$("#menuBtn").addEventListener("click", ()=>{ sidebar.classList.add("open"); scrim.classList.add("show"); });
scrim.addEventListener("click", ()=>{ sidebar.classList.remove("open"); scrim.classList.remove("show"); });
</script>
</body>
</html>
